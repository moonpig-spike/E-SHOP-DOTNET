name: "CodeQL Manual Build"
description: "Build steps used between CodeQL init and analyze when build-mode=manual."
inputs:
  language:
    description: "CodeQL language (e.g. csharp, java-kotlin, cpp)"
    required: true
  solution:
    description: "Optional solution or project file to build (e.g. eShopOnWeb.sln)"
    required: false

runs:
  using: "composite"
  steps:
    - name: Setup .NET (C#)
      if: ${{ inputs.language == 'csharp' }}
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: "8.0.x"
    - name: Restore + Build (C#)
      if: ${{ inputs.language == 'csharp' }}
      shell: bash
      run: |
        set -euo pipefail
        dotnet --info
        if [ -n "${{ inputs.solution }}" ]; then
          dotnet restore "${{ inputs.solution }}"
          dotnet build "${{ inputs.solution }}" -c Release --no-restore
        else
          # If your repo has a solution at root:
          dotnet restore
          dotnet build -c Release --no-restore
        fi
